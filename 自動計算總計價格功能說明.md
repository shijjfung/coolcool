# 自動計算總計價格功能說明

## ✅ 已完成的功能

現在在客戶端輸入數量後，系統會自動計算並顯示：
1. ✅ **單項總計**：每個欄位的數量 × 價格 = 單項總計（顯示在數量輸入框旁邊）
2. ✅ **總計價格**：所有有價格的欄位總和（顯示在表格底部）

## 📊 功能展示

### 客戶端表單顯示

```
┌─────────────────────────────────────────────┐
│ 欄位          │ 內容                        │
├──────────────┼─────────────────────────────┤
│ 高麗菜口味    │ [數量輸入框]  = 180元      │
│ 90元 *       │ (輸入 2)                    │
├──────────────┼─────────────────────────────┤
│ 泡菜口味      │ [數量輸入框]  = 300元      │
│ 100元 *      │ (輸入 3)                    │
├──────────────┼─────────────────────────────┤
│ 總計價格：    │ 480 元                      │
│ (綠色背景)    │                             │
└─────────────────────────────────────────────┘
```

## 🎯 使用說明

### 步驟 1：老闆創建表單

1. **添加欄位並設定價格**
   - 欄位 1：高麗菜口味，價格：90 元
   - 欄位 2：泡菜口味，價格：100 元

### 步驟 2：客戶填寫表單

1. **輸入數量**
   - 在「高麗菜口味」欄位輸入數量：2
   - 系統自動計算：2 × 90 = **180元**（顯示在輸入框旁邊）

2. **繼續輸入**
   - 在「泡菜口味」欄位輸入數量：3
   - 系統自動計算：3 × 100 = **300元**（顯示在輸入框旁邊）

3. **查看總計**
   - 表格底部自動顯示：**總計價格：480 元**

## 💡 功能特點

### 1. 即時計算

- ✅ **輸入數量後立即計算**
- ✅ **不需要點擊按鈕或刷新**
- ✅ **自動更新總計**

### 2. 視覺效果

- ✅ **單項總計**：綠色文字，顯示在數量輸入框旁邊
- ✅ **總計價格**：綠色背景區塊，大號粗體字
- ✅ **清晰易見**：一眼就能看到總金額

### 3. 智能顯示

- ✅ **只有輸入數量時才顯示單項總計**
- ✅ **只有有價格的欄位才參與計算**
- ✅ **總計價格只在有價格欄位時顯示**

## 📝 實際範例

### 範例 1：餐飲表單

**表單設定**：
- 高麗菜口味：90 元
- 泡菜口味：100 元

**客戶輸入**：
- 高麗菜口味：2 份
- 泡菜口味：3 份

**顯示結果**：
- 高麗菜口味：**= 180元**（2 × 90）
- 泡菜口味：**= 300元**（3 × 100）
- **總計價格：480 元**

### 範例 2：商品表單

**表單設定**：
- 商品A：150 元
- 商品B：200 元
- 備註：（無價格）

**客戶輸入**：
- 商品A：5 個
- 商品B：2 個
- 備註：請盡快送達

**顯示結果**：
- 商品A：**= 750元**（5 × 150）
- 商品B：**= 400元**（2 × 200）
- 備註：（不顯示價格）
- **總計價格：1150 元**

## 🔧 技術細節

### 計算邏輯

```typescript
// 計算單項總計（數量 × 價格）
const calculateItemTotal = (field: FormField): number => {
  if (!field.price || field.price <= 0) return 0;
  const quantity = parseFloat(order.order_data[field.name]) || 0;
  return quantity * field.price;
};

// 計算總計價格
const calculateTotal = (): number => {
  if (!form) return 0;
  return form.fields.reduce((total, field) => {
    return total + calculateItemTotal(field);
  }, 0);
};
```

### 顯示邏輯

1. **單項總計**：
   - 只在欄位有價格且輸入數量 > 0 時顯示
   - 顯示在數量輸入框旁邊
   - 格式：`= XX元`

2. **總計價格**：
   - 只在至少有一個欄位有價格時顯示
   - 顯示在表格底部
   - 格式：`總計價格：XXX 元`

## ✅ 總結

現在客戶端表單會自動：
- ✅ **計算單項總計**：數量 × 價格（顯示在輸入框旁邊）
- ✅ **計算總計價格**：所有有價格欄位的總和（顯示在表格底部）
- ✅ **即時更新**：輸入數量後立即計算
- ✅ **視覺清晰**：使用綠色突出顯示

**功能已完全實作，可以立即使用！** 🎉

