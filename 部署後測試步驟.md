# 部署後測試步驟

## 📋 部署狀態

您目前有：
- ✅ **Preview 部署**：已成功（來自 `chore-project-review-WQeEy` 分支）
- ✅ **Production 部署**：已成功
- 🔄 **新的部署**：正在 Building（等待完成）

---

## ✅ 測試步驟

### 步驟 1：等待部署完成

等待 **Building** 的部署完成（通常需要 1-3 分鐘）

### 步驟 2：確認部署成功

1. 前往 Vercel Dashboard > **Deployments**
2. 確認最新部署狀態為 **Ready**（綠色）
3. 點擊部署，查看 **Functions** 標籤
4. 確認以下 API 存在：
   - `/api/cron/facebook-token-refresh`
   - `/api/facebook/refresh-token`
   - `/api/facebook/token-status`
   - `/api/facebook/auto-refresh-deploy`

### 步驟 3：測試 API

#### 測試 1：檢查 Token 狀態

訪問：
```
https://your-domain.vercel.app/api/facebook/token-status
```

**預期回應**：
```json
{
  "configured": true,
  "valid": true,
  "days_remaining": XX,
  "expires_at": "2024-XX-XX...",
  "message": "Token 有效，剩餘 XX 天"
}
```

#### 測試 2：手動觸發自動刷新（測試用）

訪問：
```
https://your-domain.vercel.app/api/cron/facebook-token-refresh
```

**預期回應**：
```json
{
  "success": true,
  "message": "Token 狀態良好，剩餘 XX 天",
  "days_remaining": XX,
  "refreshed": false
}
```

或（如果需要刷新）：
```json
{
  "success": true,
  "message": "Token 已刷新，Vercel 環境變數已更新，重新部署已觸發",
  "vercel_updated": true,
  "deployment_id": "dpl_xxxxx",
  "refreshed": true
}
```

### 步驟 4：檢查管理頁面

1. 前往管理後台：`https://your-domain.vercel.app/admin`
2. 應該會看到「**Facebook Token 狀態**」卡片
3. 顯示 Token 狀態、剩餘天數、到期時間
4. 可以測試「刷新 Token」按鈕

---

## 🔍 如果測試失敗

### 檢查 Vercel Logs

1. 前往 Vercel Dashboard > **Deployments**
2. 點擊最新的部署
3. 查看 **Functions** > **Logs**
4. 搜尋錯誤訊息

### 常見問題

1. **404 錯誤**：
   - 確認檔案路徑正確
   - 確認部署已完成
   - 確認訪問的是正確的網域

2. **500 錯誤**：
   - 檢查環境變數是否已設定
   - 查看 Logs 中的錯誤訊息

3. **Token 無效**：
   - 確認 `FACEBOOK_ACCESS_TOKEN` 已正確設定
   - 確認 Token 沒有過期

---

## ✅ 完成後

如果所有測試都通過，系統會：
- ✅ 每天自動檢查 Token 狀態（每天上午 10 點，台灣時間）
- ✅ 自動刷新即將到期的 Token
- ✅ 自動更新環境變數
- ✅ 自動觸發部署

**完全不需要手動操作！** 🎉

