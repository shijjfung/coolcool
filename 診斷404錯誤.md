# 診斷 404 錯誤

## 問題說明

如果 API 返回 404 錯誤，可能的原因：

1. **API 路由文件不存在或路徑不正確**
2. **Next.js 構建時沒有包含 API 路由**
3. **文件結構問題**
4. **Vercel 部署配置問題**

## 檢查步驟

### 步驟 1：確認 API 路由文件存在

檢查以下文件是否存在：
- `pages/api/test-db.ts` ✅
- `pages/api/health.ts` ✅（新建的測試端點）
- `pages/api/forms/create.ts` ✅
- `pages/api/forms/list.ts` ✅

### 步驟 2：測試簡單的 API 端點

訪問以下 URL 測試：

1. **健康檢查端點**（最簡單）：
   ```
   https://coolcool-ten.vercel.app/api/health
   ```
   應該返回：
   ```json
   {
     "success": true,
     "message": "API 路由正常工作",
     "timestamp": "...",
     "environment": "production"
   }
   ```

2. **資料庫測試端點**：
   ```
   https://coolcool-ten.vercel.app/api/test-db
   ```

### 步驟 3：檢查 Vercel 構建日誌

1. 前往 Vercel Dashboard
2. 選擇您的專案
3. 點擊最新部署
4. 查看 **Build Logs**（構建日誌）
5. 檢查是否有以下錯誤：
   - TypeScript 編譯錯誤
   - 文件找不到錯誤
   - 構建失敗

### 步驟 4：檢查文件結構

確認 `pages/api/` 目錄結構正確：
```
pages/
  api/
    test-db.ts
    health.ts
    forms/
      create.ts
      list.ts
      [id].ts
    ...
```

## 常見問題

### 問題 1：API 路由文件在構建時被忽略

**解決方案**：
1. 檢查 `.gitignore` 是否忽略了 `pages/api/` 目錄
2. 確認所有 API 文件都已提交到 Git
3. 檢查 Vercel 構建日誌確認文件是否被包含

### 問題 2：Next.js 配置問題

**解決方案**：
檢查 `next.config.js` 是否有特殊配置導致 API 路由被忽略

### 問題 3：文件路徑不正確

**解決方案**：
確認 API 路由文件在正確的位置：
- ✅ `pages/api/health.ts` → `/api/health`
- ✅ `pages/api/test-db.ts` → `/api/test-db`
- ✅ `pages/api/forms/create.ts` → `/api/forms/create`

## 測試步驟

1. **先測試最簡單的端點**：
   ```
   https://coolcool-ten.vercel.app/api/health
   ```

2. **如果 health 端點也返回 404**：
   - 檢查 Vercel 構建日誌
   - 確認文件已正確部署
   - 檢查 Next.js 配置

3. **如果 health 端點正常，但其他端點 404**：
   - 檢查特定端點的文件是否存在
   - 檢查文件是否有語法錯誤
   - 查看 Vercel 構建日誌中的錯誤

## 需要提供的資訊

如果問題仍然存在，請提供：

1. **`/api/health` 的回應**（是否也是 404？）
2. **Vercel 構建日誌**（完整內容）
3. **Git 提交記錄**（確認 API 文件已提交）
4. **`pages/api/` 目錄的文件列表**

